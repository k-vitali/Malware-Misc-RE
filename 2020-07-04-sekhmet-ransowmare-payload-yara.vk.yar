rule crime_win32_sekhmet_ransom_1_exp {
meta:
	description = "Detects unpacked Sekhmet ransomware payload"
	author = "@VK_Intel"
	reference = "https://twitter.com/VK_Intel/status/1279508198098194432"
	tlp = "white/experiental"
	date = "2020-07-04"


strings:

$salsa20_key_prol = { 56 8b ?? ?? ?? 8b ?? ?? ?? 8b ?? ?? ?? 8b ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8d ?? ?? 81 f9 00 01 00 00 0f 45 f2 b9 6c aa 17 00 ba 7c aa 17 00 0f 44 d1 8b ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? 8b ?? ?? 89 ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 5e c3}
$crypto_func =  { 56 8b ?? ?? ?? 8b ?? ?? ?? 8b ?? ?? ?? 8b ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8d ?? ?? 81 f9 00 01 00 00 0f 45 f2 b9 6c aa 17 00 ba 7c aa 17 00 0f 44 d1 8b ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? 8b ?? ?? 89 ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 8b ?? ?? 89 ?? ?? 5e c3}


condition:
( uint16(0) == 0x5a4d and ( all of them ) )
}




