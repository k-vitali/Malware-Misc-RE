//////////////////////////////////////////////////////////////////////
//////////////// LOCKBIT RANSOMWARE //////////////////////////////////
//////////////////////////////////////////////////////////////////////
rule crime_win32_ransom_lockbit_1 {
meta:
	description = "Detects LockBit ransomware"
	author = "@VK_Intel"
	reference = "twitter"
	tlp = "white"
	date = "2020-03-27"


strings:
	$str1 = "LockBit"
	$str2 = "explorer.exe"
	$str3 = "vssadmin delete"


$code1 = {4e 8d ?? ?? 0f ?? ?? 0f ?? ?? ?? ?? ?? 8d ?? ?? 50 ff ?? ?? ?? ?? ?? 83 f8 03 74 ?? 83 f8 02 74 ?? 83 f8 06 0f ?? ?? ?? ?? ?? 6a 0a ff d3 8b f8 83 c4 04 85 ff 0f ?? ?? ?? ?? ?? b8 68 00 00 00 c7 ?? ?? ?? ?? ?? ?? 66 ?? ?? ?? 0f ?? ?? ?? ?? ?? ?? 66 83 f0 68 8a ?? ?? 66 ?? ?? ?? 0f ?? ?? ?? ?? ?? ?? 66 83 f0 68 c7 ?? ?? ?? ?? ?? ?? 66 ?? ?? ?? 0f ?? ?? ?? ?? ?? ?? 66 83 f0 68 66 ?? ?? ?? 33 c0 8a ?? ?? 32 c1 66 98 66 ?? ?? ?? 8a ?? ?? 32 c1 66 98 66 ?? ?? ?? 8a ?? ?? 32 c1 66 98 66 ?? ?? ?? 8a ?? ??}


condition:
( uint16(0) == 0x5a4d and
( 3 of them )
) or ( all of them )
}

