rule crime_win32_ransomexx_locker__dot_1 {
meta:
	description = "Detects RansomExx Ransomware Affected Texas DOT"
	author = "@VK_Intel"
	reference = "https://twitter.com/VK_Intel/status/1275133575927562241"
	tlp = "white"
	date = "2020-06-22"

strings:
	$str1 = "crypt_detect" wide
	$str2 = "cryptolocker" wide
	$str3 = "ransomware" wide


	$start_code = { 8b f0 85 f6 74 ?? 8d ?? ?? 51 56 ff d3 89 ?? ?? ?? ?? ?? 85 f6 0f ?? ?? ?? ?? ?? 8d ?? ?? e8 ?? ?? ?? ?? 8b cc 85 c9 0f ?? ?? ?? ?? ?? 8b f1 8b f9 8b d1 33 c0 81 ee e9 b4 41 00 81 ef ea b4 41 00 c6 ?? ?? ?? 81 ea eb b4 41 00 8d ?? ?? ?? 8a d8 80 e3 7f 02 ?? ?? ?? ?? ?? 32 ?? ?? ?? ?? ?? 88 ?? ?? ?? ?? ?? ?? 8d ?? ?? 80 e3 7f 02 ?? ?? ?? ?? ?? 32 ?? ?? ?? ?? ?? 88 ?? ?? ?? ?? ?? ?? 8d ?? ?? 80 e3 7f 02 ?? ?? ?? ?? ?? 32 ?? ?? ?? ?? ?? 88 ?? ?? ?? ?? ?? ?? 8d ?? ?? 80 e3 7f 02 ?? ?? ?? ?? ?? 83 c0 04 32 ?? ?? ?? ?? ?? 88 ?? ?? ?? 83 f8 1c 7c ?? 51 e8 ?? ?? ?? ?? 83 c4 04 c7 ?? ?? ?? ?? ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? 6a 00 }

condition:
( uint16(0) == 0x5a4d and
( 3 of them )
) or ( all of them )
}

